#!/usr/bin/env zsh

declare_parcel_as_script_with_stdin <<'/---'
Configure common external commands. Most such commands are POSIX-mandated
(e.g., `awk`, `sed`, `grep`); the remainder are merely sufficiently
commonplace to be effectively mandated (e.g., `less`, `mount`).
/---

#FIXME: This file has grown obscenely large. For sanity, it should be split on
#command name into one file per command (e.g., "option/grep", "option/mv").
#After doing so, the *ENTIRE* directory "00-core/option/" should be renamed to
#just "pathable/" -- which, happily, existing pathable commands use. Sweet, no?
#FIXME: Right. Let's adopt different nomenclature, please. (I know...) The
#current approach is increasingly pungent. Ideally, all options lists should be
#tabbable with prefix "${ZESHY_OPTIONS_". At the moment, they're not. Hence,
#globally rename "ZESHY_([A-Z]+)_OPTIONS" to "ZESHY_OPTIONS_\1". (Test first,
#naturally.)
#FIXME: Additionally, the whole "_IF" construct is... well, awkward. While it
#*DOES* meaningfully apply to actual conditions on shell state (e.g.,
#"_IF_INTERACTIVE"), it doesn't meaningfully apply to mere differences in which
#function was called (e.g., copy_path_recursive()). In the latter case, the
#"_IF" should simply be dropped. This gives a much more natural nomenclature
#directly relating to the underlying zeshy function: e.g., rename
#${ZESHY_OPTIONS_CP_IF_RECURSIVE} to ${ZESHY_OPTIONS_CP_RECURSIVE}.

#FIXME: It's an enormous headache, but global definition should be shifted to
#the new style to reduce redundancy (and file length). See below.

#FIXME: Rename "_IF_INTERACTIVE" and "_IF_NONINTERACTIVE" to "_IF_CLI" and
#"_IF_NONCLI", respectively. Naturally, this requires similar changes to parcel
#"runnable/command/option". Defer such work until after migrating interactive
#aliases to the new CLI model, as a proof of concept.
#FIXME: I wouldn't second-guess this change. Examining below, it's clear we add
#options to "_IF_INTERACTIVE" lists only really intended to be used when called
#directly from the command line: as example,
#${ZESHY_OPTIONS_DIFF_IF_INTERACTIVE}. In that specific case, it'd be quite
#dangerous to apply such options *UNLESS* already at the CLI. Doing so
#generally, as we currently do, is an obscenely bad idea. Rectify it.
#FIXME: Note, however, that what we really want is to detect whether or not such
#*ALIAS* (and not the eventual function call such alias expands to) was expanded
#directly from the CLI. This wouldn't ordinarily be terribly difficult.
#Unfortunately, in this case, most such functions are evaluated under
#run_code_paged() (e.g., grep_path_recursive()). To handle such edge cases,
#run_code_with_options_configured() should simply ignore all functions prefixed
#by "run_code" on the call stack: they don't "count" when deciding whether such
#function was called directly from the command line or not. And no, we should
#*NOT* revise is_context_cli_function() to handle such logic. We could, however,
#define a new is_context_cli_function_ignoring_runners() alias for doing so.
#Contemplate. Whatever's most natural, as always.
#FIXME: Wait! While ${ZESHY_OPTIONS_DIFF_IF_INTERACTIVE} options should clearly
#only apply when called directly from the command line, this is hardly the case
#for most commands. In fact, for most, we expressly need to retain the current
#conception of "_IF_INTERACTIVE". Consider ${ZESHY_OPTIONS_RM_IF_INTERACTIVE},
#for example. For safety, we *NEED* to apply such options whenever called under
#an interactive shell -- regardless of whether such alias was expanded directly
#at the command line. All of this implies we need to carefully consider each
#command and whether or not the options we've currently broadly defined as
#"_IF_INTERACTIVE" should actually only be applied when "_IF_CLI".

#FIXME: I'm unconvinced we need most ${ZESHY_OPTIONS_*_IF_NONINTERACTIVE}
#lists. Power users can define them explicitly if they like. But there's little
#point in doing so for *EVERY* possible command. After all, if we're going to do
#so, then (rationally speaking) we also need to define
#${ZESHY_OPTIONS_*_IF_NONCLI} lists -- which is really just extreme. So, retain
#current internal support for non-interactive and non-CLI options lists, but
#don't bother declaring them here as we currently do.

# ....................{ CHMOD                              }....................
declare_global_with_stdin list ZESHY_OPTIONS_CHMOD <<'/---'
`chmod` options specific to the change_path_permissions*() functions.
/---
ZESHY_OPTIONS_CHMOD=()

declare_global_with_stdin list ZESHY_OPTIONS_CHMOD_IF_INTERACTIVE <<'/---'
`chmod` options if run interactively.
/---
ZESHY_OPTIONS_CHMOD_IF_INTERACTIVE=(
    --changes
)

declare_global_with_stdin list ZESHY_OPTIONS_CHMOD_IF_NONINTERACTIVE <<'/---'
`chmod` options if run non-interactively.
/---
ZESHY_OPTIONS_CHMOD_IF_NONINTERACTIVE=()

declare_global_with_stdin list ZESHY_OPTIONS_CHMOD_IF_RECURSIVE <<'/---'
`chmod` options if run recursively.
/---
ZESHY_OPTIONS_CHMOD_IF_RECURSIVE=(
    --preserve-root
    --recursive
)

# ....................{ CHOWN                              }....................
declare_global_with_stdin list ZESHY_OPTIONS_CHOWN <<'/---'
`chown` options specific to the change_path_ownership*() functions.
/---
ZESHY_OPTIONS_CHOWN=()

declare_global_with_stdin list ZESHY_OPTIONS_CHOWN_IF_INTERACTIVE <<'/---'
`chown` options if run interactively.
/---
ZESHY_OPTIONS_CHOWN_IF_INTERACTIVE=(
    --changes
)

declare_global_with_stdin list ZESHY_OPTIONS_CHOWN_IF_NONINTERACTIVE <<'/---'
`chown` options if run non-interactively.
/---
ZESHY_OPTIONS_CHOWN_IF_NONINTERACTIVE=()

declare_global_with_stdin list ZESHY_OPTIONS_CHOWN_IF_RECURSIVE <<'/---'
`chown` options if run recursively.
/---
ZESHY_OPTIONS_CHOWN_IF_RECURSIVE=(
    --preserve-root
    --recursive
)

# ....................{ CP                                 }....................
declare_global_with_stdin list ZESHY_OPTIONS_CP <<'/---'
`cp` options specific to the copy_path*() functions.
/---
ZESHY_OPTIONS_CP=(
    --archive
)

declare_global_with_stdin list ZESHY_OPTIONS_CP_IF_INTERACTIVE <<'/---'
`cp` options if run interactively.
/---
ZESHY_OPTIONS_CP_IF_INTERACTIVE=(
    --interactive
    --verbose
)

declare_global_with_stdin list ZESHY_OPTIONS_CP_IF_NONINTERACTIVE <<'/---'
`cp` options if run non-interactively.
/---
ZESHY_OPTIONS_CP_IF_NONINTERACTIVE=()

declare_global_with_stdin list ZESHY_OPTIONS_CP_IF_RECURSIVE <<'/---'
`cp` options if run recursively.
/---
ZESHY_OPTIONS_CP_IF_RECURSIVE=(
    --recursive
    --update
)

declare_global_with_stdin list ZESHY_OPTIONS_CP_IF_DEEP <<'/---'
`cp` options if copying deeply (i.e., copying the targets of source symbolic
links rather than such links).
/---
ZESHY_OPTIONS_CP_IF_DEEP=(
    --dereference
)

# ....................{ DIFF                               }....................
declare_global_with_stdin list ZESHY_OPTIONS_DIFF <<'/---'
`diff` options specific to the difference_files*() and *_file_text_patch*()
functions.
/---
ZESHY_OPTIONS_DIFF=(
    --new-file
    --speed-large-files
    --unified
)

declare_global_with_stdin list ZESHY_OPTIONS_DIFF_IF_INTERACTIVE <<'/---'
`diff` options if run interactively.
/---
# Ignoring whitespace is nice when run interactively but
# otherwise dangerous.
ZESHY_OPTIONS_DIFF_IF_INTERACTIVE=(
    --ignore-all-space
    --ignore-blank-lines
    --ignore-space-change
)

declare_global_with_stdin list ZESHY_OPTIONS_DIFF_IF_NONINTERACTIVE <<'/---'
`diff` options if run non-interactively.
/---
ZESHY_OPTIONS_DIFF_IF_NONINTERACTIVE=()

declare_global_with_stdin list ZESHY_OPTIONS_DIFF_IF_RECURSIVE <<'/---'
`diff` options if run recursively.
/---
ZESHY_OPTIONS_DIFF_IF_RECURSIVE=(
    --recursive
)

# ....................{ DU                                 }....................
declare_global_with_stdin list ZESHY_OPTIONS_DU <<'/---'
`du` options specific to the print_path_size*() functions.
/---
ZESHY_OPTIONS_DU=(
    --one-file-system
)

declare_global_with_stdin list ZESHY_OPTIONS_DU_IF_INTERACTIVE <<'/---'
`du` options if run interactively.
/---
ZESHY_OPTIONS_DU_IF_INTERACTIVE=(
    --human-readable
    --total
)

declare_global_with_stdin list ZESHY_OPTIONS_DU_IF_NONINTERACTIVE <<'/---'
`du` options if run non-interactively.
/---
ZESHY_OPTIONS_DU_IF_NONINTERACTIVE=()

declare_global_with_stdin list ZESHY_OPTIONS_DU_IF_GETTING_DIR_SIZE <<'/---'
`du` options if getting the size in bytes of a single directory.
/---
ZESHY_OPTIONS_DU_IF_GETTING_DIR_SIZE=(
    --summary
    --block-size=1
)

# ....................{ DU ~ sort                          }....................
declare_global_with_stdin list ZESHY_OPTIONS_DU_SORT <<'/---'
`sort` options specific to the print_path_size_sorted*() functions.
/---
ZESHY_OPTIONS_DU_SORT=(
    --human-numeric-sort
    --reverse
)

# ....................{ FILE                               }....................
declare_global_with_stdin list ZESHY_OPTIONS_FILE <<'/---'
`file` options specific to the *_file_*() functions.
/---
ZESHY_OPTIONS_FILE=()

declare_global_with_stdin\
    list ZESHY_OPTIONS_FILE_IF_PRINTING_METADATA_SYNOPSIS <<'/---'
`file` options if printing a human-readable synopsis of file metadata.
/---
ZESHY_OPTIONS_FILE_IF_PRINTING_METADATA_SYNOPSIS=(
    --dereference
)

# ....................{ GREP                               }....................
# Avoid defining global ${GREP_OPTION}. Doing so coerces such options on *ALL*
# invocations of "grep", including invocation by shell scripts expecting
# machine- rather than human-readable output (e.g., no line numbers or colors).
# To avoid breaking the entire system, avoid such global like the plague it is.

declare_global_with_stdin list ZESHY_OPTIONS_GREP <<'/---'
`grep` options specific to the grep*() functions.
/---
ZESHY_OPTIONS_GREP=(
    --binary-files=without-match
    --exclude-dir='.bzr'
    --exclude-dir='.cvs'
    --exclude-dir='.git'
    --exclude-dir='.hg'
    --exclude-dir='.svn'
    --no-messages
    --perl-regexp
)

declare_global_with_stdin list ZESHY_OPTIONS_GREP_IF_INTERACTIVE <<'/---'
`grep` options if run interactively.
/---
ZESHY_OPTIONS_GREP_IF_INTERACTIVE=(
    --color=always
    --line-number
    --with-filename
)

declare_global_with_stdin list ZESHY_OPTIONS_GREP_IF_NONINTERACTIVE <<'/---'
`grep` options if run non-interactively.
/---
ZESHY_OPTIONS_GREP_IF_NONINTERACTIVE=()

declare_global_with_stdin list ZESHY_OPTIONS_GREP_IF_CASELESS <<'/---'
`grep` options if run case-insensitively.
/---
ZESHY_OPTIONS_GREP_IF_CASELESS=(
    --ignore-case
)

declare_global_with_stdin list ZESHY_OPTIONS_GREP_IF_RECURSIVE <<'/---'
`grep` options if run recursively.
/---
ZESHY_OPTIONS_GREP_IF_RECURSIVE=(
    --recursive
)

declare_global_with_stdin list ZESHY_OPTIONS_GREP_IF_SILENT <<'/---'
`grep` options if run silently.
/---
ZESHY_OPTIONS_GREP_IF_SILENT=(
    --silent
)

# ....................{ LESS                               }....................
declare_global_with_stdin string LESS <<'/---'
Whitespace-delimited `less` options. Such options apply to all `less`
invocations, including those by external commands (e.g., `man`), and hence are
_not_ `zeshy`-specific.
/---
LESS="${LESS---LONG-PROMPT --RAW-CONTROL-CHARS --shift=.05}"

declare_global_with_stdin list ZESHY_OPTIONS_LESS_IF_INTERACTIVE <<'/---'
`less` options specific to the page_safely() function.
/---
ZESHY_OPTIONS_LESS_IF_INTERACTIVE=(
    # Display the current pager position in the 'prompt' (i.e., the last line).
    --LONG-PROMPT

    # Display raw control characters, excluding ANSI escape sequences.
    --RAW-CONTROL-CHARS

    # Avoid clearing the screen on initialization.
    --no-init

    # When scrolling horizontally, 'shift' the screen by a number of columns
    # equal to %5 of the current terminal width.
    --shift=.05
)

# ....................{ LN ~ symbolic                      }....................
declare_global_with_stdin list ZESHY_OPTIONS_LN_SYMBOLIC <<'/---'
`ln` options specific to the make_link_symbolic*() functions.
/---
ZESHY_OPTIONS_LN_SYMBOLIC=(
    --symbolic
)

declare_global_with_stdin list ZESHY_OPTIONS_LN_SYMBOLIC_IF_INTERACTIVE <<'/---'
`ln` options if run interactively.
/---
ZESHY_OPTIONS_LN_SYMBOLIC_IF_INTERACTIVE=(
    --interactive
    --verbose
)

declare_global_with_stdin list ZESHY_OPTIONS_LN_SYMBOLIC_IF_NONINTERACTIVE <<'/---'
`ln` options if run non-interactively.
/---
ZESHY_OPTIONS_LN_SYMBOLIC_IF_NONINTERACTIVE=()

# ....................{ LS                                 }....................
declare_global_with_stdin list ZESHY_OPTIONS_LS <<'/---'
`ls` options specific to the list_path*() functions.
/---
ZESHY_OPTIONS_LS=()

declare_global_with_stdin list ZESHY_OPTIONS_LS_IF_INTERACTIVE <<'/---'
`ls` options if run interactively.
/---
ZESHY_OPTIONS_LS_IF_INTERACTIVE=(
    --all
    --color=always
    --group-directories-first
    --human-readable
    --indicator-style=classify
    --quoting-style=shell
    --sort=version
    --time-style=long-iso
)

declare_global_with_stdin list ZESHY_OPTIONS_LS_IF_NONINTERACTIVE <<'/---'
`ls` options if run non-interactively.
/---
ZESHY_OPTIONS_LS_IF_NONINTERACTIVE=()

declare_global_with_stdin list ZESHY_OPTIONS_LS_IF_CONCISE <<'/---'
`ls` options if run concisely (i.e., non-verbosely).
/---
ZESHY_OPTIONS_LS_IF_CONCISE=(
    --format=vertical
)

declare_global_with_stdin list ZESHY_OPTIONS_LS_IF_RECURSIVE <<'/---'
`ls` options if run recursively.
/---
ZESHY_OPTIONS_LS_IF_RECURSIVE=(
    --format=long
    --recursive
)

declare_global_with_stdin list ZESHY_OPTIONS_LS_IF_VERBOSE <<'/---'
`ls` options if run verbosely.
/---
ZESHY_OPTIONS_LS_IF_VERBOSE=(
    --format=long
)

# ....................{ MKDIR                                 }....................
declare_global_with_stdin list ZESHY_OPTIONS_MKDIR <<'/---'
`zeshy`-specific `mkdir` options (e.g., for make_dir()).
/---
ZESHY_OPTIONS_MKDIR=()

declare_global_with_stdin list ZESHY_OPTIONS_MKDIR_IF_INTERACTIVE <<'/---'
`zeshy`-specific `mkdir` options when run from the interactive command line.
/---
ZESHY_OPTIONS_MKDIR_IF_INTERACTIVE=(
    --parent
    --verbose
)

declare_global_with_stdin list ZESHY_OPTIONS_MKDIR_IF_NONINTERACTIVE <<'/---'
`zeshy`-specific `mkdir` options when run from a non-interactive script.
/---
ZESHY_OPTIONS_MKDIR_IF_NONINTERACTIVE=()

declare_global_with_stdin list ZESHY_OPTIONS_MKDIR_IF_NOT_FOUND <<'/---'
`zeshy`-specific `mkdir` options when ignoring nonextant directories.
/---
ZESHY_OPTIONS_MKDIR_IF_NOT_FOUND=(
    --parent
)

# ....................{ MV                                 }....................
declare_global_with_stdin list ZESHY_OPTIONS_MV <<'/---'
`mv` options specific to the move_path*() functions.
/---
ZESHY_OPTIONS_MV=()

declare_global_with_stdin list ZESHY_OPTIONS_MV_IF_INTERACTIVE <<'/---'
`mv` options if run interactively.
/---
ZESHY_OPTIONS_MV_IF_INTERACTIVE=(
    --interactive
    --verbose
)

declare_global_with_stdin list ZESHY_OPTIONS_MV_IF_NONINTERACTIVE <<'/---'
`mv` options if run non-interactively.
/---
ZESHY_OPTIONS_MV_IF_NONINTERACTIVE=()

# ....................{ NL                                 }....................
declare_global_with_stdin list ZESHY_OPTIONS_NL <<'/---'
`nl` options specific to the number_string_lines*() functions.
/---
ZESHY_OPTIONS_NL=(
    -ba
)

declare_global_with_stdin list ZESHY_OPTIONS_NL_IF_INTERACTIVE <<'/---'
`nl` options if run interactively.
/---
ZESHY_OPTIONS_NL_IF_INTERACTIVE=()

declare_global_with_stdin list ZESHY_OPTIONS_NL_IF_NONINTERACTIVE <<'/---'
`nl` options if run non-interactively.
/---
ZESHY_OPTIONS_NL_IF_NONINTERACTIVE=()

# ....................{ NM                                 }....................
declare_global_with_stdin list ZESHY_OPTIONS_NM <<'/---'
`nm` options specific to the print_binary_executable_symbols() function.
/---
ZESHY_OPTIONS_NM=()

declare_global_with_stdin list ZESHY_OPTIONS_NM_IF_INTERACTIVE <<'/---'
`nm` options if run interactively.
/---
ZESHY_OPTIONS_NM_IF_INTERACTIVE=(
    --demangle
    --line-numbers
    --print-armap
    --print-size
)

declare_global_with_stdin list ZESHY_OPTIONS_NM_IF_NONINTERACTIVE <<'/---'
`nm` options if run non-interactively.
/---
ZESHY_OPTIONS_NM_IF_NONINTERACTIVE=()

declare_global_with_stdin list ZESHY_OPTIONS_NM_IF_BINARY_EXECUTABLE_DYNAMIC <<'/---'
`nm` options if passed a dynamically linked executable binary.
/---
ZESHY_OPTIONS_NM_IF_BINARY_EXECUTABLE_DYNAMIC=(
    --dynamic
)

# ....................{ PATCH                               }....................
declare_global_with_stdin list ZESHY_OPTIONS_PATCH <<'/---'
`patch` options specific to the apply_file_patch*() functions.
/---
ZESHY_OPTIONS_PATCH=(
    --no-backup-if-mismatch
    --remove-empty-files
)

declare_global_with_stdin list ZESHY_OPTIONS_PATCH_IF_INTERACTIVE <<'/---'
`patch` options if run interactively.
/---
ZESHY_OPTIONS_PATCH_IF_INTERACTIVE=()

declare_global_with_stdin list ZESHY_OPTIONS_PATCH_IF_NONINTERACTIVE <<'/---'
`patch` options if run non-interactively.
/---
ZESHY_OPTIONS_PATCH_IF_NONINTERACTIVE=()

# ....................{ RM                                 }....................
declare_global_with_stdin list ZESHY_OPTIONS_RM <<'/---'
`rm` options for `zeshy`-specific path removers (e.g., remove_path_recursive()).
/---
ZESHY_OPTIONS_RM=(
    --one-file-system
    --preserve-root
)

declare_global_with_stdin list ZESHY_OPTIONS_RM_IF_INTERACTIVE <<'/---'
`rm` options if run interactively.
/---
ZESHY_OPTIONS_RM_IF_INTERACTIVE=(
    --dir
    --verbose
)

#FIXME: The distinction between this options list and
#${ZESHY_OPTIONS_RM_IF_INTERACTIVE_AND_ARGS_4_OR_MORE} will cease to be
#interesting, after we add dry run capability to remove_path() and friends. In
#such case, shift option "-i" to ${ZESHY_OPTIONS_RM_IF_INTERACTIVE} and excise
#these two lists.
declare_global_with_stdin list\
    ZESHY_OPTIONS_RM_IF_INTERACTIVE_AND_ARGS_1_TO_3 <<'/---'
`rm` options if run interactively and passed only one to three paths to remove.
/---
ZESHY_OPTIONS_RM_IF_INTERACTIVE_AND_ARGS_1_TO_3=(
    -i
)

declare_global_with_stdin list\
    ZESHY_OPTIONS_RM_IF_INTERACTIVE_AND_ARGS_4_OR_MORE <<'/---'
`rm` options if run interactively and passed at least four paths to remove.
/---
ZESHY_OPTIONS_RM_IF_INTERACTIVE_AND_ARGS_4_OR_MORE=(
    -I
)

declare_global_with_stdin list ZESHY_OPTIONS_RM_IF_NONINTERACTIVE <<'/---'
`rm` options if run non-interactively.
/---
ZESHY_OPTIONS_RM_IF_NONINTERACTIVE=()

declare_global_with_stdin list ZESHY_OPTIONS_RM_IF_RECURSIVE <<'/---'
`rm` options if run recursively.
/---
ZESHY_OPTIONS_RM_IF_RECURSIVE=(
    --recursive
)

declare_global_with_stdin list\
    ZESHY_REMOVE_PATH_RECURSIVE_BLACKLIST_DIRNAMES <<'/---'
List of absolute paths of directories to be blacklisted from recursive removal.
Specifically, when at least one such path is passed to a `zeshy`-specific
recursive path remover (e.g., remove_path_recursive()):

* If the current shell is interactive _and_ `rm` option `-i` is set (e.g., by
  ${ZESHY_OPTIONS_RM_IF_INTERACTIVE}), such remover interactively confirms such
  removal with the current user. Given the severity of such removal,
  sufficiently strong confirmation is required (e.g., typing `YES`). If such
  confirmation is _not_ received, such removal fails.
* Else, such removal fails.

Hence, blacklisted directories _cannot_ be removed non-interactively.
/---
# Since the "rm" command already supports blacklisting the "/" directory with
# option "--preserve-root", this list excludes such directory by default.
ZESHY_REMOVE_PATH_RECURSIVE_BLACKLIST_DIRNAMES=(
    '/bin'
    '/boot'
    '/dev'
    '/etc'
    '/home'
    '/lib32'
    '/lib64'
    '/opt'
    '/proc'
    '/root'
    '/sbin'
    '/sys'
    '/usr'
    '/usr/bin'
    '/usr/include'
    '/usr/lib32'
    '/usr/lib64'
    '/usr/libexec'
    '/usr/local'
    '/usr/local/bin'
    '/usr/local/sbin'
    '/usr/sbin'
    '/usr/share'
    '/usr/src'
    '/var'
)

# ....................{ RMDIR                                 }....................
declare_global_with_stdin list ZESHY_OPTIONS_RMDIR <<'/---'
`rmdir` options specific to the remove_dir*() functions.
/---
ZESHY_OPTIONS_RMDIR=()

declare_global_with_stdin list ZESHY_OPTIONS_RMDIR_IF_INTERACTIVE <<'/---'
`rmdir` options if run interactively.
/---
ZESHY_OPTIONS_RMDIR_IF_INTERACTIVE=(
    --verbose
)

declare_global_with_stdin list ZESHY_OPTIONS_RMDIR_IF_NONINTERACTIVE <<'/---'
`rmdir` options if run non-interactively.
/---
ZESHY_OPTIONS_RMDIR_IF_NONINTERACTIVE=()
