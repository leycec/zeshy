#!/usr/bin/env zsh
# --------------------( LICENSE                            )--------------------
# Copyright 2007-2014 by Cecil Curry.
# See "COPYING" for additional details.

:parcel <<'/---'
Handle *globbable list testers* (i.e., functions testing list items against glob
expressions).
/---

# ....................{ EXCEPTIONS                         }....................
:func_ '<globbable> :void die_unless_list_item_matches_glob(
    :string list_name,
    :string glob,
    :string error_message =
        "List \$\{${list_name}\} item matching \"${glob}\" not found.")'
:func{
    die_unless_args_2_to_3\
        'Expected one list name, one glob, and optional error message.'
    is_list_item_matches_glob "${@[1,2]}" or {
        :string list_name="${1}" glob="${2}"
        die "${3-List \$\{${list_name}\} item matching \"${glob}\" not found.}"
    }
}:func <<'/---'
Throw an exception with the passed message unless the passed list contains an
item matching the passed glob.
/---

# ....................{ TESTERS                            }....................
:func_ '<globbable> [status = :bool] is_list_item_matches_glob(
    :string:list? list_name, :string glob)' :func{
    #FIXME: Surely there exists a more efficient implementation avoiding such
    #function call and hence the setting of such placeholder variable?
    { get_list_index_first_matching_glob_if_found "${@}" } :silent
}:func <<'/---'
Report success if the passed list contains an item matching the passed glob:
e.g.,

.is_list_item_matches_glob()
==========================================
[source]
------------------------------------------
>>> :list on_fundamentalism; on_fundamentalism=(
...    "As for the second notion, the idea that we could lose our freedom by"
...    "succumbing to a wave of religious hysteria, I am sorry to say that I"
...    "consider it possible. I hope that it is not probable. But there is a"
...    "latent deep strain of religious fanaticism in this, our culture; it is"
...    "rooted in our history and it has broken out many times in the past. It"
...    "is with us now; there has been a sharp rise in strongly evangelical"
...    "sects in this country in recent years, some of which hold beliefs"
...    "theocratic in the extreme, anti-intellectual, anti-scientific, and"
...    "anti-libertarian. It is a truism that almost any sect, cult, or"
...    "religion will legislate its creed into law if it acquires the political"
...    "power to do so, and will follow it by suppressing opposition,"
...    "subverting all education to seize early the minds of the young, and by"
...    "killing, locking up, or driving underground all heretics. This is"
...    "equally true whether the faith is Communism or HolyRollerism; indeed it"
...    "is the bounden duty of the faithful to do so. The custodians of the"
...    "True Faith cannot logically admit tolerance of heresy to be a virtue." )
>>> is_list_item_matches_glob on_fundamentalism *'anti-'[[:WORD:]]* and\
...     :string.output "Man is not a rational animal, he is a rationalizing animal."
Man is not a rational animal, he is a rationalizing animal.
------------------------------------------
==========================================
/---

# --------------------( WASTELANDS                         )--------------------
