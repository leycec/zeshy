#!/usr/bin/env zsh
# ====================[ core                               ]====================
#                     [ Time-stamp: "2009-04-18 19:29:36 leycec" ]
#
# --------------------( SYNOPSIS                           )--------------------
# Zeshy Core, implementing core functionality not readily definable in another
# Zeshy component.

# ....................{ GETTERS                            }....................
# float get_zsh_version(void)
#
# Get the current version of Zsh as a comparable floating point number.
get_zsh_version() {
    die_unless_no_args
    print "${ZSH_VERSION}"
} 

# float get_zeshy_version(void)
#
# Get the current version of Zeshy as a comparable floating point number.
get_zeshy_version() {
    die_unless_no_args
    print 0.1
}

# ....................{ SETUP                              }....................
setup_zeshy() {
    is_interactive and
        setup_if_interactive or
        setup_if_non_interactive
    setup_if_installed
}

# ....................{ SETUP ~ interactive                }....................
# If this shell is attached to a terminal device, set terminal-specific options.
setup_if_interactive() {
    setup_mimetypes
    setup_terminal
    setup_theme_key_bindings
    setup_theme_styles
    setup_theme_prompt
    setup_if_interactive_globals
    setup_if_interactive_installed
}

setup_if_interactive_globals() {
    # Absolute paths of the preferred command-line editor and pager.
    global_string\
        EDITOR="${EDITOR:-"$(get_first_command_path emacs vim nano ed)"}"\
        PAGER="${PAGER:-"$(get_first_command_path less more)"}"
}

# ....................{ SETUP ~ non-interactive            }....................
setup_if_non_interactive() {
#   print "process command name: $(get_process_command_name)"
}

# ....................{ SETUP ~ commands                   }....................
# Conditionally setup non-interactive commands, if installed.
setup_if_installed() {
    is_installed X and setup_X
}

# Conditionally setup interactive-only commands, if installed.
setup_if_interactive_installed() {
    is_installed keychain and setup_keychain
}

#FIXME: Obsolete.
    # Set the default script name prior to all other logic, as any logic
    # raising an error requires this name for logging that error. Only do this
    # if the current process is not an interactive Zsh shell as, in that case,
    # the get_script_name() function dynamically inspects the script name from
    # the function call stack.
    # Strip the filetype from this script's basename, if present.
#   global_string ZESHY_SCRIPT_NAME="${$(get_process_command_name)%%.*}"

    # Default the script name to "zeshy", if "zsh".
#   is "${ZESHY_SCRIPT_NAME}" == zsh si and ZESHY_SCRIPT_NAME=zeshy

# --------------------( COPYRIGHT AND LICENSE              )--------------------
# The information below applies to everything in this distribution,
# except where noted.
#              
# Copyright 2007-2012 by Cecil Curry.
#   
#   http://www.raiazome.com
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program. If not, see <http://www.gnu.org/licenses/>.
