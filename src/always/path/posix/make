#!/usr/bin/env zsh
# ====================[ make                               ]====================
#
# --------------------( LICENSE                            )--------------------
# Copyright 2007-2012 by Cecil Curry.
# See "COPYING" for additional details.
#
# --------------------( SYNOPSIS                           )--------------------
# Handle path creation.

# ....................{ MAKERS ~ dir                       }....................
document_function '
void make_dir(string dirname1, string dirname2, ...)

Silently make all passed directories but not parent directories of such
directories. If any such directory already exists, throw an exception.
'
function make_dir() {
    die_unless_args 'expected at least one dirname'
    run_with_options 'command mkdir' ZESHY_MKDIR_OPTIONS -- "${(q)@}"
}

document_function '
void make_dir_if_not_found(string dirname1, string dirname2, ...)

Silently make all passed directories and parent directories of such directories
that do not already exist (i.e., ignoring those directories that do exist).
'
function make_dir_if_not_found() {
    die_unless_args 'expected at least one dirname'
    run_with_options 'command mkdir'\
        'ZESHY_MKDIR_OPTIONS ZESHY_MKDIR_OPTIONS_IF_NOT_FOUND' -- "${(q)@}"
}

#FIXME: Implement make_dir_if_not_found_with_options(). (Don't worry about
#make_dir_with_options(), for now. We have no need of it, I should think.)

# ....................{ MAKERS ~ link : symbolic           }....................
#FIXME: Description no longer quite right. And the implementation *CERTAINLY*
#isn't right.
#FIXME: Implement make_link_symbolic_with_options().

document_function '
void make_link_symbolic(string source_pathname, string target_filename)

Silently link the passed source path to target symbolic link. If either such
path does not exist or such link exists, throw an exception.
'
function make_link_symbolic() {
    # Validate passed arguments.
    die_unless_args_2 'expected one source pathname and one target filename'

    #FIXME: Call run_with_options_configured and rename this function.
    # Make such link.
    list ln; ln=( ln "${ZESHY_LN_SYMBOLIC_OPTIONS[@]}" )
    if is_shell_interactive
    then "${ln[@]}" "${ZESHY_LN_SYMBOLIC_OPTIONS_IF_SHELL_INTERACTIVE[@]}"    -- "${@}"
    else "${ln[@]}" "${ZESHY_LN_SYMBOLIC_OPTIONS_IF_SHELL_NONINTERACTIVE[@]}" -- "${@}"
    fi
}

# --------------------( WASTELANDS                         )--------------------
#if no passed directories exist or throw an exception if any such
#directory exists.
# If such link already exists and is a symbolic link, replace such file without error;
#otherwise, raise an error if such file already exists.
    #FIXME: For orthoganality (and possible cross-platform concerns), add a new
    #${ZESHY_MKDIR_OPTIONS_IF_NOT_FOUND}).
#
# See make_dir_if_not_found() for an alternative throwing no such exception.
