#!/usr/bin/env zsh
# ====================[ pastebin                           ]====================
#
# --------------------( LICENSE                            )--------------------
# Copyright 2007-2013 by Cecil Curry.
# See "COPYING" for additional details.
#
# --------------------( SYNOPSIS                           )--------------------
# Handle text file pastebinning.

# ....................{ WRITERS ~ remote                   }....................
#FIXME: Add support for alternative pasters.
#FIXME: Actually, this is *DAMN* silly. Just reimplement wgetpaste in Zeshy. The
#fewer external dependencies in the core Zeshy codebase, by far the better.
#We'll probably still need at least one of either "curl" or "wget", but that's
#*QUITE* an improvement. (Indeed, since "wgetpaste" strictly requires "wget",
#abstracting out such to pasting to use either "curl" or "wget" as dynamically
#available is already demonstrable improvement.)

declare_function '
void pastebin_file(string filename)

Upload the contents of the passed file to the default pastebin provider
currently configured with such utility. The
resulting upload will be publicly accessible in plaintext format, and hence best
applicable for logs.
'
function pastebin_file() {
    # Validate passed arguments.
    die_unless_arg 'expected one filename'
    string pastebin_file="${1}"
    die_unless_pathable wgetpaste

    # Paste such file.
    print_message "pastebinning \"${pastebin_file}\"..."
    print_file_text "${pastebin_file}" | wgetpaste --raw --verbose
}

# --------------------( WASTELANDS                         )--------------------
