#!/usr/bin/env zsh
# ====================[ prompt                             ]====================
#
# --------------------( LICENSE                            )--------------------
# Copyright 2007-2013 by Cecil Curry.
# See "COPYING" for additional details.
#
# --------------------( SYNOPSIS                           )--------------------
# Handle color-specific prompt escape codes.

# ....................{ GLOBALS ~ prompt                   }....................
document_global '
map ZESHY_PROMPT_COLOR

Map lowercase color name followed by optional attributes to the prompt-specific
ANSI escape code enabling such color at the shell prompt on the current
terminal. See ${ZESHY_COLOR} for further details.
'
document_global '
map ZESHY_PROMPT_COLOR_2

Map lowercase color name followed by optional attributes to the prompt-specific
ANSI escape code enabling such color at the shell prompt on monochrome terminals
(i.e., *NOT* supporting the canonical eight colors). See ${ZESHY_COLOR} for
further details.
'
document_global '
map ZESHY_PROMPT_COLOR_8

Map lowercase color name followed by optional attributes to the prompt-specific
ANSI escape code enabling such color at the shell prompt on polychrome terminals
(i.e., supporting the canonical eight colors). See ${ZESHY_COLOR} for further
details and ${ZESHY_COLOR_NAMES_8} for a list of such colors.
'

# ....................{ GLOBALS ~ glob                     }....................
document_global '
string ZESHY_PROMPT_COLOR_GLOB

Glob matching color-specific zsh prompt escape codes.
'
# Dismantled, this is:
#
# * "%(...)", matching a "%"-prefixed prompt escape.
# * "[BbSsUu]", matching a bold, italic, or underline parameter.
# * "[0-9]##[FfKk]", matching a fore- or background parameter prefixed by
#   integer argument consisting of one or more digits.
# * "[FfKk]\{?*\}", matching a fore- or background parameter suffixed by:
#   * String argument consisting of a well-known color name (e.g., "red").
#   * Integer argument consisting of one or more digits.
ZESHY_PROMPT_COLOR_GLOB='%([BbSsUu]|[0-9]##[FfKk]|[FfKk]\{?*\})'

# ....................{ REMOVERS                           }....................
document_function '
string remove_string_prompt_colors(string text1, string text2, ...)

Remove all zsh color codes from the passed string. The resulting string will
retain non-color prompt escapes (e.g., "%D", expanding to the current date).
'
function remove_string_prompt_colors() {
    die_unless_args 'expected at least one string'
    remove_string_matches "${*}" "${ZESHY_PROMPT_COLOR_GLOB}"
}

# --------------------( WASTELANDS                         )--------------------
