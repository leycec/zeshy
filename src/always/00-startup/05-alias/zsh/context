#!/usr/bin/env zsh
# --------------------( LICENSE                            )--------------------
# Copyright 2007-2013 by Cecil Curry.
# See "COPYING" for additional details.

declare_parcel_as_script_with_stdin <<'-/-'
Handle `zsh` *context* (i.e., lowercase strings describing the current shell
execution environment) aliases.
-/-

# ....................{ GLOBALS                            }....................
declare_global_with_stdin string_constant ZESHY_CONTEXT_ROOT='toplevel' <<'/---'
String assigned to ${zsh_eval_context} elements whose corresponding runnables
run under *root context*. See is_context_root() for further details.
/---

# ....................{ TESTERS                            }....................
declare_alias_with_stdin\
    '[status: boolean] is_context_cli(void)'\
    'is -o interactive and "${ZSH_EVAL_CONTEXT}" == "'${ZESHY_CONTEXT_ROOT}'" si' <<'/---'
Return success if the current shell context is the *root CLI context*.
Specifically, return success if this alias is expanded by the current user
directly at an interactive command line: e.g.,

.is_context_cli()
==========================================
[source]
------------------------------------------
>>> string on_golden_ages=\
...    "We may not appreciate the fact; but a fact nevertheless it remains: we
...     are living in a Golden Age, the most gilded Golden Age of human history
...     — not only of past history, but of future history. For, as Sir Charles
...     Darwin and many others before him have pointed out, we are living like
...     drunken sailors, like the irresponsible heirs of a millionaire uncle. At
...     an ever accelerating rate we are now squandering the capital of metallic
...     ores and fossil fuels accumulated in the earth’s crust during hundreds
...     of millions of years. How long can this spending spree go on? Estimates
...     vary. But all are agreed that within a few centuries or at most a few
...     millennia, Man will have run through his capital and will be compelled
...     to live, for the remaining nine thousand nine hundred and seventy or
...     eighty centuries of his career as Homo sapiens, strictly on income."
>>> is_context_cli and get_string_line "${on_golden_ages}" -1
eighty centuries of his career as Homo sapiens, strictly on income.
------------------------------------------
==========================================
/---

declare_alias_with_stdin\
    '[status: boolean] is_context_root(void)'\
    'is "${ZSH_EVAL_CONTEXT}" == "'${ZESHY_CONTEXT_ROOT}'" si' <<'/---'
Return success if the current shell context is the *root context*. Specifically,
return success if this alias is expanded either by the current user directly at
an interactive command line _or_ by the top-level of a non-interactive shell
script: e.g.,

.is_context_root()
==========================================
[source]
------------------------------------------
>>> string on_authoritarian_demagoguery=\
...    "One Folk, One Realm, One Leader. Union with the unity of an insect
...     swarm. Knowledgeless understanding of nonsense and diabolism. And then
...     the newsreel camera had cut back to the serried ranks, the swastikas,
...     the brass bands, the yelling hypnotist on the rostrum. And here once
...     again, in the glare of his inner light, was the brown insectlike column,
...     marching endlessly to the tunes of this rococo horror-music. Onward Nazi
...     soldiers, onward Christian soldiers, onward Marxists and Muslims, onward
...     every chosen People, every Crusader and Holy War-maker. Onward into
...     misery, into all wickedness, into death!"
>>> is_context_root and get_string_line "${on_authoritarian_demagoguery}" 1
One Folk, One Realm, One Leader. Union with the unity of an insect
------------------------------------------
==========================================
/---

# --------------------( WASTELANDS                         )--------------------
#>>> is_context_root and print_string\
#...     "Facts do not cease to exist because they are ignored."
#Facts do not cease to exist because they are ignored.
#(i.e., either directly by the current user from an
#interactive command line or by top-level of a non-interactive shell script).
