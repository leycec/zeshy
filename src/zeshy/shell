#!/usr/bin/env zsh
# ====================[ shell                              ]====================
#                     [ Time-stamp: "2009-04-18 19:29:36 leycec" ]
#
# --------------------( SYNOPSIS                           )--------------------
# Zeshy Shell. This Zeshy component implements shell-handling functionality.

# --------------------( ALIASES                            )--------------------
# Mimes.
alias zsh-mime-load="zsh-mime-setup -f"
alias zsh-mime-edit="${EDITOR} /etc/mailcap; zsh-mime-load"

# --------------------( SOURCES                            )--------------------
# void redot(void)
#
# Resource all Zsh startup scripts in the same order Zsh sources these scripts
# on initial login for the current user. This function is of principal use for
# Zeshy developers (making frequent changes to Zeshy itself) as well as Zsh
# dot-file hackers (making frequent changes to Zsh dot-files).
redot() {
    [[ "${#}" -eq 0 ]] || die 'expected no arguments'

    initialize_imports
    local ZESHY_SCRIPT_NAME='redot'
    utter "reloading user ${USER}..."
    source_if_found '/etc/zsh/zprofile'
    source_if_found "${HOME}/.zprofile"
    source_if_found '/etc/zsh/zshrc'
    source_if_found "${HOME}/.zshrc"
    source_if_found '/etc/zsh/zlogin'
    source_if_found "${HOME}/.zlogin"
}

# void source_if_found(char *filename)
#
# Source the passed filename if found and readable by the current user.
source_if_found() {
    [[ "${#}" -eq 1 ]] || die 'expected exactly one filename'
    local script_name="${1}"
    if [[ -f "${script_name}" && -r "${script_name}" ]]; then
        utter_import "${script_name}"
        source "${script_name}"
    fi
}

#FIXME: Obsolete?
# void redit(void)
#redit() {
#  if [ "$USER" = "root" ]
#  then sudo $EDITOR /etc/zsh/zshrc
#  else      $EDITOR $HOME/.zshrc
#  fi
#
#  redot
#}

# --------------------( COPYRIGHT AND LICENSE              )--------------------
# The information below applies to everything in this distribution,
# except where noted.
#              
# Copyleft 2007-2010 by Cecil Curry.
#   
#   http://www.raiazome.com
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program. If not, see <http://www.gnu.org/licenses/>.
