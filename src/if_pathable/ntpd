#!/usr/bin/env zsh
# ====================[ ntpd                               ]====================
#
# --------------------( LICENSE                            )--------------------
# Copyright 2007-2013 by Cecil Curry.
# See "COPYING" for additional details.
#
# --------------------( SYNOPSIS                           )--------------------
# Handle the Network Time Protocol (NTP), synchronizing local system time with
# remote time servers.

# ....................{ PRINTERS                           }....................
declare_function '
string print_ntpd(void)

Print a human-readable profile of the currently running NTP daemon and hence the
current status of synchronizing local system time with remote time servers.
'
function print_ntpd() {
    #FIXME: If "ntpd" isn't running, try to start it before simply dying.
    #Naturally, this suggests a new pair of start_service() and stop_service()
    #functions abstracting out responsibility for doing so, with appropriate
    #OS- and distro-specific implementations.

    # Validate sanity.
    die_if_args
    die_unless_command_running ntpd

    # Print such profile.
    {
        print_heading 'local NTP daemon'
        ntpq -c readvar
        print_heading 'remote NTP peers'
        ntpq -p
        print_heading 'time-related kernel variables'
        ntptime
    } | page_stdin
}

# --------------------( WASTELANDS                         )--------------------
