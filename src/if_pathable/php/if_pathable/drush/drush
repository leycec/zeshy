#!/usr/bin/env zsh
# --------------------( LICENSE                            )--------------------
# Copyright 2007-2013 by Cecil Curry.
# See "COPYING" for additional details.

declare_parcel_as_script_with_stdin <<'-/-'
Handle Drush, a CLI utility for manipulating both local and remote Drupal sites.
-/-

#FIXME: Integrate "/usr/share/doc/drush-*/examples/example.bashrc.bz2", an
#absurdly complete bash-specific "drush" implementation -- including drush
#completions, aliases, functions, globals, and so on.

# ....................{ GETTERS                            }....................
declare_function_with_stdin <<'/---'
string get_drush_site_alias_default(void)

Get the first site alias defined by the first user-specific `drush`
configuration file (e.g., `~/.drush/aliases.drushrc.php`), excluding the
obligatory site alias `@none`. If no such alias exists (e.g., due to no such
file existing or such file failing to define an alias), an exception is thrown.
/---
function get_drush_site_alias_default() {
    # Validate sanity.
    die_if_args
    string config_filename

    #FIXME: Call set_list_to_drush_site_aliases().
    # List of all such aliases.
}

# ....................{ SETTERS                            }....................
declare_function_with_stdin <<'/---'
void set_list_to_drush_site_aliases(string list_name)

Set the passed list (ideally, list set) to all site alias defined by `drush`
configuration files for the current user (e.g., `~/.drush/aliases.drushrc.php`),
excluding the obligatory site alias `@none`.
/---
function set_list_to_drush_site_aliases() {
    # Validate sanity.
    die_if_args
    string list_name__sltdsa="${1}" site_aliases__sltdsa
    die_unless_list "${list_name__sltdsa}"

    # Set such list to such aliases, split on newline.
    set_list_to_string_lines list_name__sltdsa "$(command drush site-alias)"

    #FIXME: Define function remove_list_element().

    # Omit the refuse alias "@none".
    remove_list_element "${list_name__sltdsa}" '@none'
}

# --------------------( WASTELAND                          )--------------------
#    config_filename="$(get_drush_config_file_site_aliases)"
#    die_unless_file_text "${config_filename}"
#    get_file_text_matches_glob_
#    [[:blank:]]#'$aliases['("'"[^\']#"'"|'"'('\"'|[^\"])#'"')']'[[:blank:]]#'='*
#declare_function_with_stdin <<'/---'
#string get_drush_config_file_site_aliases(void)
#
#Get the absolute path of the user-specific `drush` configuration file of site
#aliases (e.g., `~/.drush/aliases.drushrc.php`).
#/---
#function get_drush_config_file_site_aliases() {
#    #FUXME: There exist a number of possible configuration files defining such
#    #aliases, of which this is merely the most common.
#    die_if_args
#    output_string "${HOME}/.drush/aliases.drushrc.php"
#}
