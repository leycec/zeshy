#!/usr/bin/env zsh
# ====================[ dpms                               ]====================
#
# --------------------( LICENSE                            )--------------------
# Copyright 2007-2013 by Cecil Curry.
# See "COPYING" for additional details.
#
# --------------------( SYNOPSIS                           )--------------------
# Handle X11 Display Power Management Signaling (DPMS).

# ....................{ PRINTERS                           }....................
document_function '
string print_x_dpms_info(void)

Print a human-readable synopsis of current X11 DPMS settings.
'
function print_x_dpms_info() {
    die_if_args
#   interactively print_message 'displaying X11 DPMS settings...'
    _print_x_dpms_info
}

#FIXME: This is pretty hideous.
function _print_x_dpms_info() {
    die_if_args
    string xset_output="$(xset -q)"
    print "${xset_output}" | grep '^Screen Saver:$'       --after-context=2
    print "${xset_output}" | grep '^DPMS (Energy Star):$' --after-context=2
}

# ....................{ SETTERS                            }....................
#FIXME: If non-interactive, don't print anything -- just do it.
document_function '
void disable_x_dpms(void)

Disable screen blanking (i.e., DPMS-managed monitor shutdown on inactivity).
This is particularly helpful while enjoying media but should be manually re-
enabled when done.
'
function disable_x_dpms() {
    die_if_args
    interactively print_message 'disabling X11 DPMS...'
    xset s off
    xset -dpms
    print_x_dpms_info
}

#FIXME: If non-interactive, don't print anything -- just do it.
document_function '
void enable_x_dpms(void)

Enable screen blanking (i.e., DPMS-managed monitor shutdown on inactivity).
'
function enable_x_dpms() {
    die_if_args
    interactively print_message 'enabling X11 DPMS...'
    xset s on
    xset +dpms
    print_x_dpms_info
}

# --------------------( WASTELANDS                         )--------------------
